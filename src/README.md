# Source for generating API docs.

This directory contains source code for generating the images for the API docs.

## Guiding Principles

The idea here is to just have a way to regenerate images for the API docs when
the rendering or other aspects of the output change. It should be something that
doesn't require a lot of work to regenerate. For some assets, a script may be
necessary. It should be well documented here what the prerequisites and
limitations of the script are (what platform should it be run on?, etc.).

# The Generators

There is a script `generate.sh` that will generate all of the asset images from
the generator Dart files in the subdirectories, except for the color swatches.
It should be run on a MacOS machine.

For usage, run `./generate.sh --help`.

### Prerequisites

  - ImageMagick (`brew install imagemagick`).
  - optipng (`brew install optipng`).

## Generating color swatches

Because there's no way to pass startup parameters to a program (and currently
--route [doesn't work](https://github.com/flutter/flutter/issues/10813)), the
color swatches are generated by hand by by running

```shell
flutter run material/colors.dart | tee colors.log
```

Then grabbing screenshots by tapping through the swatches manually, hitting
`s` in the terminal window after each tap.  This will create screen shots in the
directory you run flutter in. Once you've captured all the images, hit Ctrl-C
and do the following:

```shell
mkdir /tmp/colors
mv flutter_[0-9][0-9].png colors.log /tmp/colors
cd /tmp/colors
awk -F: '/^I\/flutter.*BASH:/ {print $3}' colors.log > colors.sh
bash ./colors.sh
optipng -zc1-9 -zm1-9 -zs0-3 -f0-5 Colors.*.png # optimize images.
```

And then move the `Colors.*.png` images into place in the
[material](https://github.com/flutter/assets-for-api-docs/tree/master/material)
directory.